<div class="bg-dark px-6 py-7 flex justify-between md:mx-10 md:my-14 md:mb-8 md:rounded-lg">
  <div class="space-y-1">
    <%= link_to 'javascript:history.back()', class: "flex items-center gap-4 group" do %>
      <%= inline_svg_tag "shared/icon-arrow-left.svg", class: "*:!stroke-white" %>
      <span class="group-hover:underline inline-block text-white font-bold text-sm">Go back</span>
    <% end %>
    <p class="font-bold text-white text-lg">Roadmap</p>
  </div>
  <%= link_to new_suggestion_path, class: "btn btn--accent flex items-center gap-2" do %>
    <span class="text-center">+</span>
    <span>Add feedback</span>
  <% end %>
</div>
<!-- Mobile Tabs -->
<div class="border-b border-b-dark-muted/25 grid grid-cols-3 md:hidden">
  <% ["planned", "in-progress", "live"].each do |status| %>
    <%= link_to "#{status.capitalize} (#{Suggestion.where(status: status).count})", 
                roadmap_index_path(status: status), 
                class: "tab #{'tab--selected' if params[:status].blank? && status == 'planned' || params[:status] == status}" %>
  <% end %>
</div>
<div class="p-6">
  <!-- Mobile View -->
  <div class="space-y-1 mb-6 md:hidden">
    <% current_status = params[:status].presence || 'planned' %>
    <p class="font-bold text-lg text-dark">
      <%= current_status.capitalize %> (<%= Suggestion.where(status: current_status).count %>)
    </p>
    <p class="text-dark-muted text-sm">
      <%= case current_status
          when 'planned' then "Ideas prioritized for research"
          when 'in-progress' then "Features currently being developed"
          when 'live' then "Released features"
          end %>
    </p>
  </div>
  <!-- Mobile Suggestions List -->
  <div class="flex flex-col gap-4 md:hidden">
    <%= render partial: 'roadmap/suggestion', collection: @suggestions.select { |s| s.status == current_status } %>
  </div>
  <!-- Desktop View -->
  <div class="grid-cols-3 gap-4 mx-10 hidden md:grid auto-rows-min">
    <% statuses = { "planned" => "Ideas prioritized for research", 
                   "in-progress" => "Features currently being developed", 
                   "live" => "Released features" } %>
    <!-- Headers Row -->
    <% statuses.each do |status, description| %>
      <div class="text-left ">
        <p class="text-dark font-bold"><%= status.capitalize %> (<%= Suggestion.where(status: status).count %>)</p>
        <p class="text-dark-muted"><%= description %></p>
      </div>
    <% end %>
    <!-- Calculate Max Rows for Grid Alignment -->
    <% max_rows = statuses.keys.map { |status| @suggestions.count { |s| s.status == status } }.max %>
    <!-- Grid Layout for Suggestions -->
    <% (0...max_rows).each do |i| %>
      <% statuses.keys.each do |status| %>
        <div class="h-full">
          <% suggestion = @suggestions.select { |s| s.status == status }[i] %>
          <% if suggestion %>
            <%= render partial: 'roadmap/suggestion', locals: { suggestion: suggestion } %>
          <% else %>
            <div class="invisible h-full"></div>
          <% end %>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
