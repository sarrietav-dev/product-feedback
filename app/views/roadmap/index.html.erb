<div class="bg-dark px-6 py-7 flex justify-between md:mx-10 md:my-14 md:mb-8 md:rounded-lg">
  <div class="space-y-1">
    <%= link_to 'javascript:history.back()', class: "flex items-center gap-4 group" do %>
      <%= inline_svg_tag "shared/icon-arrow-left.svg", class: "*:!stroke-white" %>
      <span class="group-hover:underline inline-block text-white font-bold text-sm">Go back</span>
    <% end %>
    <p class="font-bold text-white text-lg">Roadmap</p>
  </div>
  <%= link_to new_suggestion_path, class: "btn btn--accent flex items-center gap-2" do %>
    <span class="text-center">+</span>
    <span>Add feedback</span>
  <% end %>
</div>
<!-- Mobile Tabs -->
<div class="border-b border-b-dark-muted/25 grid grid-cols-3 md:hidden">
  <%= link_to "Planned (#{Suggestion.where(status: 'planned').count})", roadmap_index_path(status: 'planned'), class: "tab #{'tab--selected' if params[:status].blank? || params[:status] == 'planned'}" %>
  <%= link_to "In-Progress (#{Suggestion.where(status: 'in-progress').count})", roadmap_index_path(status: 'in-progress'), class: "tab #{'tab--selected' if params[:status] == 'in-progress'}" %>
  <%= link_to "Live (#{Suggestion.where(status: 'live').count})", roadmap_index_path(status: 'live'), class: "tab #{'tab--selected' if params[:status] == 'live'}" %>
</div>
<div class="p-6">
  <!-- Mobile View -->
  <div class="space-y-1 mb-6 md:hidden">
    <% if params[:status].blank? || params[:status] == 'planned' %>
      <p class="font-bold text-lg text-dark">Planned (<%= Suggestion.where(status: "planned").count %>)</p>
      <p class="text-dark-muted text-sm">Ideas prioritized for research</p>
    <% elsif params[:status] == 'in-progress' %>
      <p class="font-bold text-lg text-dark">In-Progress (<%= Suggestion.where(status: "in-progress").count %>)</p>
      <p class="text-dark-muted text-sm">Features currently being developed</p>
    <% elsif params[:status] == 'live' %>
      <p class="font-bold text-lg text-dark">Live (<%= Suggestion.where(status: "live").count %>)</p>
      <p class="text-dark-muted text-sm">Released features</p>
    <% end %>
  </div>
  <div class="flex flex-col gap-4 md:hidden">
    <%= render partial: 'roadmap/suggestion', collection: @suggestions.select { |item| item.status == (params[:status].presence || 'planned') } %>
  </div>
  <!-- Desktop View with Headers Inside Grid -->
  <div class="grid grid-cols-3 gap-4 mx-10 hidden md:grid auto-rows-min">
    <!-- Row 1: Column Headers (Locked at the Top) -->
    <div class="text-center font-bold">
      Planned (<%= Suggestion.where(status: "planned").count %>)
      <p class="text-dark-muted">Ideas prioritized for research</p>
    </div>
    <div class="text-center font-bold">
      In-Progress (<%= Suggestion.where(status: "in-progress").count %>)
      <p class="text-dark-muted">Features currently being developed</p>
    </div>
    <div class="text-center font-bold">
      Live (<%= Suggestion.where(status: "live").count %>)
      <p class="text-dark-muted">Released features</p>
    </div>
    <!-- Row-Based Card Grid (Forcing Each Row to Align) -->
    <% max_rows = [@suggestions.count { |s| s.status == "planned" },
                 @suggestions.count { |s| s.status == "in-progress" },
                 @suggestions.count { |s| s.status == "live" }].max %>
    <% (0...max_rows).each do |i| %>
      <div class="h-full">
        <% planned = @suggestions.select { |s| s.status == "planned" }[i] %>
        <% if planned %>
          <%= render partial: 'roadmap/suggestion', locals: { suggestion: planned } %>
        <% else %>
          <div class="invisible h-full"></div>
        <% end %>
      </div>
      <div class="h-full">
        <% in_progress = @suggestions.select { |s| s.status == "in-progress" }[i] %>
        <% if in_progress %>
          <%= render partial: 'roadmap/suggestion', locals: { suggestion: in_progress } %>
        <% else %>
          <div class="invisible h-full"></div>
        <% end %>
      </div>
      <div class="h-full">
        <% live = @suggestions.select { |s| s.status == "live" }[i] %>
        <% if live %>
          <%= render partial: 'roadmap/suggestion', locals: { suggestion: live } %>
        <% else %>
          <div class="invisible h-full"></div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
